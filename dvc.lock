schema: '2.0'
stages:
  features@opensmile:
    cmd: python src/features/opensmile.py
    deps:
    - path: ./dist/wav
      md5: 6a19fd0e6ce397d26db84382ad1d8fb8.dir
      size: 441896594
      nfiles: 4601
    params:
      params.yaml:
        opensmile:
          featureSet: compare16/ComParE_2016.conf
    outs:
    - path: ./dist/features/opensmile
      md5: f324921fd39fee8bd3983a204f0df573.dir
      size: 2673594511
      nfiles: 2
  features@deepspectrum:
    cmd: python src/features/deepspectrum.py
    deps:
    - path: ./dist/wav
      md5: 6a19fd0e6ce397d26db84382ad1d8fb8.dir
      size: 441896594
      nfiles: 4601
    params:
      params.yaml:
        deepspectrum:
          extractionNetwork: densenet201
          plotMode: mel
          melBands: 128
          colourMap: viridis
          window_size:
          hop_size:
    outs:
    - path: ./dist/features/deepspectrum
      md5: caf6520b49bb59a528f1d1b1b43b2df0.dir
      size: 106433533
      nfiles: 1
  audeep_spectrograms:
    cmd: python src/features/audeep/spectrograms.py
    deps:
    - path: ./dist/wav
      md5: 6a19fd0e6ce397d26db84382ad1d8fb8.dir
      size: 441896594
      nfiles: 4601
    - path: ./src/features/audeep/spectrograms.py
      md5: c923552b50b4fcff3f6b53583fa0a6ac
      size: 2148
    params:
      params.yaml:
        audeep.spectrograms:
          window_width: 0.08
          window_overlap: 0.04
          mel_bands: 128
          fixed_length: 3
          clip_below_values:
          - -30
          - -45
          - -60
          - -75
    outs:
    - path: ./audeep_workspace/spectrograms
      md5: 7c73f000957e473f8ab916c35eb532e2.dir
      size: 698815072
      nfiles: 4
  audeep_autoencoder:
    cmd: python src/features/audeep/autoencoder.py
    deps:
    - path: ./audeep_workspace/spectrograms
      md5: 7c73f000957e473f8ab916c35eb532e2.dir
      size: 698815072
      nfiles: 4
    params:
      params.yaml:
        audeep.autoencoder:
          num_layers: 2
          num_units: 256
          cell: GRU
          bidirectional_encoder: false
          bidirectional_decoder: true
          num_epochs: 64
          batch_size: 512
          learning_rate: 0.001
          keep_prob: 0.8
    outs:
    - path: ./audeep_workspace/autoencoder
      md5: 81ce006bb536aa9110954e7a899404fd.dir
      size: 8293220080
      nfiles: 524
  audeep_representatins:
    cmd: ./runIn default ./src/features/audeep/representations.py
    deps:
    - path: ./audeep_workspace/autoencoder
      md5: 6003932ff5cfa632fb708d65c3d47cd1.dir
      size: 8293235002
      nfiles: 524
    outs:
    - path: ./audeep_workspace/representations
      md5: 8af81b3bcd6a456c5a080363b6088946.dir
      size: 152669018
      nfiles: 5
  xbow:
    cmd: python src/features/xbow.py
    deps:
    - path: ./dist/features/opensmile
      md5: f324921fd39fee8bd3983a204f0df573.dir
      size: 2673594511
      nfiles: 2
    params:
      params.yaml:
        opensmile.featureSet: compare16/ComParE_2016.conf
        xbow:
          csize: 2000
          num_assignments: 200
    outs:
    - path: ./dist/features/xbow
      md5: 75ab4348af28d08906f9aa8c710e8e0b.dir
      size: 70261255
      nfiles: 2
  audeep_export:
    cmd: python src/features/audeep/export.py
    deps:
    - path: ./audeep_workspace/representations
      md5: d2f63637b69b46e1f035b307bcea09ee.dir
      size: 152669018
      nfiles: 5
    params:
      params.yaml:
        audeep.export: fused
    outs:
    - path: ./dist/features/audeep
      md5: b4baae96390d93076ffe3ad0d1dcd148.dir
      size: 219826327
      nfiles: 1
  svm@opensmile:
    cmd: python src/ml/svm.py opensmile
    deps:
    - path: ./dist/features/opensmile
      md5: f324921fd39fee8bd3983a204f0df573.dir
      size: 2673594511
      nfiles: 2
    - path: ./dist/lab
      md5: b6caf93f6708b2e410bd410c8230187c.dir
      size: 126769
      nfiles: 3
    - path: ./src/ml/svm.py
      md5: 863b1136bfc30f3d2669be14a256edf0
      size: 7455
    outs:
    - path: ./metrics/svm/opensmile/metrics.yaml
      md5: f828cf2201c24a67477c47e024001812
      size: 1274
    - path: ./results/svm/opensmile
      md5: 4b872f922c3bff3a87f1a3eff822b8d1.dir
      size: 126110
      nfiles: 7
  svm@deepspectrum:
    cmd: python src/ml/svm.py deepspectrum
    deps:
    - path: ./dist/features/deepspectrum
      md5: caf6520b49bb59a528f1d1b1b43b2df0.dir
      size: 106433533
      nfiles: 1
    - path: ./dist/lab
      md5: b6caf93f6708b2e410bd410c8230187c.dir
      size: 126769
      nfiles: 3
    - path: ./src/ml/svm.py
      md5: 863b1136bfc30f3d2669be14a256edf0
      size: 7455
    outs:
    - path: ./metrics/svm/deepspectrum/metrics.yaml
      md5: e6b6e5d9017f5e1ce1e63acc748184ce
      size: 1279
    - path: ./results/svm/deepspectrum
      md5: b50f76d585792aebef4da791c4701c5d.dir
      size: 126670
      nfiles: 7
  svm@audeep:
    cmd: python src/ml/svm.py audeep
    deps:
    - path: ./dist/features/audeep
      md5: b4baae96390d93076ffe3ad0d1dcd148.dir
      size: 219826327
      nfiles: 1
    - path: ./dist/lab
      md5: b6caf93f6708b2e410bd410c8230187c.dir
      size: 126769
      nfiles: 3
    - path: ./src/ml/svm.py
      md5: 863b1136bfc30f3d2669be14a256edf0
      size: 7455
    outs:
    - path: ./metrics/svm/audeep/metrics.yaml
      md5: dd5d47fc4bed0247b408a2e436a98f3f
      size: 1281
    - path: ./results/svm/audeep
      md5: 2b5131234dde0b14f4e2f73a61cb3c7c.dir
      size: 129246
      nfiles: 7
  svm@xbow:
    cmd: python src/ml/svm.py xbow
    deps:
    - path: ./dist/features/xbow
      md5: 75ab4348af28d08906f9aa8c710e8e0b.dir
      size: 70261255
      nfiles: 2
    - path: ./dist/lab
      md5: b6caf93f6708b2e410bd410c8230187c.dir
      size: 126769
      nfiles: 3
    - path: ./src/ml/svm.py
      md5: 863b1136bfc30f3d2669be14a256edf0
      size: 7455
    outs:
    - path: ./metrics/svm/xbow/metrics.yaml
      md5: d5f78b64026eb235c52b9963b4e69e7a
      size: 1271
    - path: ./results/svm/xbow
      md5: ae72b3a7781b04df15a5941bb65ce7b7.dir
      size: 127163
      nfiles: 7
  fusion:
    cmd: python src/late_fusion.py
    deps:
    - path: results/svm/
      md5: c1f5f8f76c77a72c9df03bc998fca32d.dir
      size: 509228
      nfiles: 29
    params:
      params.yaml:
        fusion:
          to_fuse:
          - audeep
          - deepspectrum
          - opensmile
          - xbow
    outs:
    - path: metrics/fusion/metrics.yaml
      md5: 10f175adf05178248e095b94fed6ac53
      size: 1277
    - path: results/fusion/
      md5: 395245ae5b4d31d35cf17c47a63c139b.dir
      size: 79068
      nfiles: 3
  cm:
    cmd: python src/visualisations/cm.py
    deps:
    - path: ./results
      md5: c0283a709a5ee3bc5fe79d4708b1c80c.dir
      size: 588304
      nfiles: 33
    - path: ./src/visualisations/cm.py
      md5: fb4bbd2085039e9259ab11c0291a6dca
      size: 2948
    outs:
    - path: ./visualisations/cms
      md5: 9cd4ca1c865e57f820f30a56ea1a3191.dir
      size: 1215750
      nfiles: 20
  audeep_representations:
    cmd: python src/features/audeep/representations.py
    deps:
    - path: ./audeep_workspace/autoencoder
      md5: 81ce006bb536aa9110954e7a899404fd.dir
      size: 8293220080
      nfiles: 524
    outs:
    - path: ./audeep_workspace/representations
      md5: d2f63637b69b46e1f035b307bcea09ee.dir
      size: 152669018
      nfiles: 5
  test:
    cmd: python -c "import numpy"
